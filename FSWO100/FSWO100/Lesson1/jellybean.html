<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Jellybean Test</title>
</head>
<body>
    <h1>Hello, World</h1>
    <script>
        console.log("Hello, moku World!");

        let bag = [

            {
                "id": "jb1",
                "color": "pink"
            },
            {
                "id": "jb2",
                "color": "green"
            },
            {
                "id": "jb3",
                "color": "yellow"
            },
            {
                "id": "jb4",
                "color": "pink"
            },
            {
                "id": "jb5",
                "color": "pink"
            },
            {
                "id": "jb6",
                "color": "yellow"
            },
            {
                "id": "jb7",
                "color": "green"
            },
            {
                "id": "jb8",
                "color": "green"
            },
            {
                "id": "jb9",
                "color": "pink"
            },
            {
                "id": "jbA",
                "color": "pink"
            }

        ];

        /*
         * Algorithm
         * 
         */
        let cupA = [];
        let cupB = [];
        let cupC = [];

        let i;
        let bagLength = bag.length;
        for (i = 0; i < bagLength; i++) {

            let jellybean = pullFromBag();
            pushToCups(jellybean);

        };

        let smallest = findLeastCup();
        if (doesLeftmostCupHaveLeast() === false) {

            pushCupAToBag();
            pushToEmpty(smallest);
            pushToEmptyCup();
        }

        let greatest = findGreatestCup();
        if (doesRightmostCupHaveMost() === false) {
            console.log("Lump me some cold sausage gravy flakes!");
            pushCupCToBag();
            pushToEmpty(largest);
            pushToEmptyCup();
        }

        displayALLCups();




        /*
         * Support functions
         * 
         */
        function pullFromBag() {

            return (bag !== null && bag.length > 0) ? bag.pop() : null;
        }
        function pushToCups(jellybean) {

            if (cupA.length > 0 && cupA[0].color === jellybean.color) {
                cupA.push(jellybean);
            }
            else if (cupB.length > 0 && cupB[0].color === jellybean.color) {
                cupB.push(jellybean);
            }
            else if (cupC.length > 0 && cupC[0].color === jellybean.color) {
                cupC.push(jellybean);
            }
            else if (cupA.length === 0) {
                cupA.push(jellybean);
            }
            else if (cupB.length === 0) {
                cupB.push(jellybean);
            }
            else {
                cupC.push(jellybean);
            }
        }
        function pushCupAToBag() {
            pushToBag("A");
        }
        function pushCupBToBag() {
            pushToBag("B");
        }
        function pushCupCToBag() {
            pushToBag("C");
        }
        function pushToBag(cup) {
            let i;
            let empty = findEmptyCup();

            if (empty === "E") {
                if (cup === "A" && cupA.length > 0) {
                    for (i = cupA.length - 1; i >= 0; i--) {
                        let jellybean = cupA.pop();
                        bag.push(jellybean);
                    }
                }
                else if (cup === "B" && cupB.length > 0) {
                    for (i = cupB.length - 1; i >= 0; i--) {
                        let jellybean = cupB.pop();
                        bag.push(jellybean);
                    }
                }
                else if (cup === "C" && cupC.length > 0) {
                    for (i = cupC.length - 1; i >= 0; i--) {
                        let jellybean = cupC.pop();
                        bag.push(jellybean);
                    }
                }
            }
        }
        function pushToEmpty(cup) {
            let i;
            let empty = findEmptyCup();
            if (empty !== "E") {

                if (cup === "A" && cupA.length > 0) {
                    if (empty === "B") {
                        for (i = cupA.length - 1; i >= 0; i--) {
                            let jellybean = cupA.pop();
                            cupB.push(jellybean);
                        }
                    }
                    else if (empty === "C") {
                        for (i = cupA.length - 1; i >= 0; i--) {
                            let jellybean = cupA.pop();
                            cupC.push(jellybean);
                        }
                    }
                }
                else if (cup === "B" && cupB.length > 0) {
                    if (empty === "A") {
                        for (i = cupB.length - 1; i >= 0; i--) {
                            let jellybean = cupB.pop();
                            cupA.push(jellybean);
                        }
                    }
                    else if (empty === "C") {
                        for (i = cupB.length - 1; i >= 0; i--) {
                            let jellybean = cupB.pop();
                            cupC.push(jellybean);
                        }
                    }
                }
                else if (cup === "C" && cupC.length > 0) {
                    if (empty === "A") {
                        for (i = cupC.length - 1; i >= 0; i--) {
                            let jellybean = cupC.pop();
                            cupA.push(jellybean);
                        }
                    }
                    else if (empty === "B") {
                        for (i = cupC.length - 1; i >= 0; i--) {
                            let jellybean = cupC.pop();
                            cupB.push(jellybean);
                        }
                    }
                }
            }
        }
        function pushToEmptyCup() {
            let i;
            let empty = findEmptyCup();
            if (bag.length > 0 && empty !== "E") {

                if (empty === "A") {
                    for (i = bag.length - 1; i >= 0; i--) {
                        let jellybean = bag.pop();
                        cupA.push(jellybean);
                    }
                }
                if (empty === "B") {
                    for (i = bag.length - 1; i >= 0; i--) {
                        let jellybean = bag.pop();
                        cupB.push(jellybean);
                    }
                }
                if (empty === "C") {
                    for (i = bag.length - 1; i >= 0; i--) {
                        let jellybean = bag.pop();
                        cupC.push(jellybean);
                    }
                }
            }
        }
        function doesLeftmostCupHaveLeast() {
            let cup = findLeastCup();
            return cup === "A" ? true : false;
        }
        function doesRightmostCupHaveMost() {
            let cup = findGreatestCup();
            return cup === "C" ? true : false;
        }
        function findLeastCup() {

            if (cupA.length === 0 || cupB.length === 0 ||
                cupC.length === 0) {

                return "E";
            }

            let cupSelect = "A";
            if (cupB.length < cupA.length) {

                if (cupC.length < cupB.length) {
                    cupSelect = "C";
                }
                else {
                    cupSelect = "B";
                }
            }

            return cupSelect;
        }
        function findGreatestCup() {

            if (cupA.length === 0 || cupB.length === 0 ||
                cupC.length === 0) {

                return "E";
            }

            let cupSelect = "C";
            if (cupC.length < cupB.length) {

                if (cupB.length < cupA.length) {
                    cupSelect = "A";
                }
                else {
                    cupSelect = "B";
                }
            }

            return cupSelect;
        }
        function findEmptyCup() {

            if (cupA.length > 0 && cupB.length > 0 &&
                cupC.length > 0) {

                return "E";
            }
            let cupSelect = "C";
            if (cupC.length > 0) {

                if (cupB.length > 0) {
                    cupSelect = "A";
                }
                else {
                    cupSelect = "B";
                }
            }

            return cupSelect;
        }

        function displayALLCups() {
            let i;
            console.log("Jellybeans in bag: " + bag.length);
            console.log("Cup A : " + cupA.length);
            for (i = 0; i < cupA.length; i++) {
                console.log(cupA[i].id + " " + cupA[i].color);
            }
            console.log("Cup B : " + cupB.length);
            for (i = 0; i < cupB.length; i++) {
                console.log(cupB[i].id + " " + cupB[i].color);
            }
            console.log("Cup C : " + cupC.length);
            for (i = 0; i < cupC.length; i++) {
                console.log(cupC[i].id + " " + cupC[i].color);
            }
        }
        function displayBag() {
            let i;
            console.log("Remaining in bag: " + bag.length);
            for (i = 0; i < bag.length; i++) {
                console.log(bag[i].id + " " + bag[i].color);
            }
        }

    </script>
</body>
</html>